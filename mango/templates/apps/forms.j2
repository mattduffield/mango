import markupsafe
from typing import Text
from starlette_wtf import StarletteForm, CSRFProtectMiddleware, csrf_protect
from wtforms import (
  StringField, 
  TextAreaField, 
  PasswordField, 
  EmailField, 
  SelectField,
  BooleanField,
  FormField,
  Form,
)
from wtforms.validators	import DataRequired, NoneOf
from mango.core.forms import (
  label_class, 
  chk_class, 
  input_class, 
  select_class, 
  textarea_class, 
  QuerySelectField
)


class {{ra.label}}Form(StarletteForm):
  {% for field in ra.fields %}
  {{field.name}} = {{field.element_type}}(
    '{{field.label}}', 
    validators=[{% for val in field.validators %}{{val}}{% endfor %}]{% if field.element_attributes %},{% endif %} 
    {% if field.element_attributes %}render_kw={ {% for k, v in field.element_attributes.items() %} "{{k}}":"{{v}}", {% endfor %} }{% endif %}
  )
  {% endfor %}

  def layout_fields(self):
    fields = [
      {% for field in ra.page_layout %}
        {
          '{{field.field_type}}': '{{field.name}}', 
          'css_class': '{{field.css_class}}', 
          'fields': [
            {% for inner in field.page_layout %}
              {
                '{{inner.field_type}}': self.{{inner.name}}, 
                'css_class': {{inner.css_class}},
                'label_class': {{inner.label_class}}
              },
            {% endfor %}
          ]
        },
      {% endfor %}
    ]
    return fields

